---
import { navLinks } from "../data/navLinks";
---

<nav aria-label="Navigație principală">
  <div class="mx-auto max-w-7xl xl:max-w-screen-2xl px-4 sm:px-6 lg:px-8 relative z-50 flex justify-between py-4">
    <!-- LEFT -->
    <div class="relative z-10 flex items-center gap-16">
      <!-- Brand -->
      <a aria-label="Home" href="/" class="flex items-center gap-3">
        <!-- Logo simplu (în snippet e SVG; aici e echivalent vizual, curat) -->
        <div class="h-10 w-10 rounded-full bg-cyan-500"></div>
        <div class="leading-tight">
          <div class="text-base font-semibold text-gray-900">Dr. Cirimpei Tatiana</div>
          <div class="text-sm text-gray-600">Radioterapie</div>
        </div>
      </a>

      <!-- Desktop links -->
      <div id="rt-nav-desktop" class="hidden lg:flex lg:gap-10">
        {navLinks.map((item) => (
            <a
            href={item.href}
            data-rt-nav-item
            class="relative -mx-3 -my-2 rounded-lg px-3 py-2 text-sm text-gray-700 transition-colors delay-150 hover:text-gray-900 hover:delay-0"
            >
            <span class="relative z-10">{item.label}</span>
            </a>
        ))}
      </div>
    </div>

    <!-- RIGHT -->
    <div class="flex items-center gap-6">
      <!-- Mobile: hamburger only -->
      <div class="lg:hidden">
        <button
          id="rt-menu-btn"
          class="cursor-pointer relative z-10 -m-2 inline-flex items-center rounded-lg stroke-gray-900 p-2 hover:bg-gray-200/50 hover:stroke-gray-600 active:stroke-gray-900 focus:outline-none focus-visible:ring-2 focus-visible:ring-gray-400/60"
          aria-label="Toggle site navigation"
          type="button"
          aria-expanded="false"
          aria-controls="rt-mobile-menu"
        >
          <svg viewBox="0 0 24 24" fill="none" aria-hidden="true" class="h-6 w-6">
            <path
              d="M5 6h14M5 18h14M5 12h14"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </button>
      </div>

      <!-- Desktop buttons only -->
      <div class="flex items-center gap-6 max-lg:hidden">
        <a
          class="inline-flex justify-center rounded-lg border py-2 px-3 text-sm transition-colors border-gray-300 text-gray-700 hover:border-gray-400 active:bg-gray-100 active:text-gray-700/80"
          href="/contact"
        >
          Contact
        </a>

        <a
          class="inline-flex justify-center rounded-lg py-2 px-3 text-sm font-semibold transition-colors bg-gray-800 text-white hover:bg-gray-900 active:bg-gray-800 active:text-white/80"
          href="/programare"
        >
          Programează-te
        </a>
      </div>
    </div>
  </div>

  <!-- Mobile menu (hidden on desktop) -->
  <div id="rt-mobile-menu" class="hidden lg:hidden px-4 sm:px-6">
    <div class="rounded-2xl border border-gray-200 bg-white p-4 shadow-sm">
      <div class="flex flex-col gap-1">
        {navLinks.map((item) => (
          <a
            href={item.href}
            class="rounded-lg px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-gray-900"
          >
            {item.label}
          </a>
        ))}
      </div>

      <div class="mt-4 flex gap-3">
        <a
          class="inline-flex w-1/2 justify-center rounded-lg border py-2 px-3 text-sm transition-colors border-gray-300 text-gray-700 hover:border-gray-400 active:bg-gray-100"
          href="/contact"
        >
          Contact
        </a>
        <a
          class="inline-flex w-1/2 justify-center rounded-lg py-2 px-3 text-sm font-semibold transition-colors bg-gray-800 text-white hover:bg-gray-900 active:bg-gray-800 active:text-white/80"
          href="/programare"
        >
          Programează-te
        </a>
      </div>
    </div>
  </div>

 <script>
    // @ts-nocheck
  // ===== Mobile menu =====
  const btn = document.getElementById("rt-menu-btn");
  const menu = document.getElementById("rt-mobile-menu");

  if (btn && menu) {
    btn.addEventListener("click", () => {
      const isOpen = btn.getAttribute("aria-expanded") === "true";
      btn.setAttribute("aria-expanded", String(!isOpen));
      menu.classList.toggle("hidden");
    });
  }

  // ===== Guards (performanță + accesibilitate) =====
  const reduceMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
  const isDesktop = window.matchMedia("(min-width: 1024px)").matches;

  // Dacă userul vrea motion redus SAU nu suntem pe desktop -> nu inițializăm animația
  if (reduceMotion || !isDesktop) {
    // (opțional) poți return-a direct
  } else {
    // ===== Hover pill (FLIP) pentru desktop nav =====
    const desktopNav = document.getElementById("rt-nav-desktop");
    const items = desktopNav ? desktopNav.querySelectorAll("[data-rt-nav-item]") : [];

    const pill = document.createElement("span");
    pill.className = "absolute inset-0 rounded-lg bg-gray-100 pointer-events-none";
    pill.style.opacity = "0";
    pill.style.transform = "none";
    pill.style.transformOrigin = "50% 50% 0px";
    pill.style.transition = "opacity 300ms cubic-bezier(.2,.8,.2,1), transform 300ms cubic-bezier(.2,.8,.2,1)";

    /** @type {HTMLElement|null} */
    let currentEl = null;

    /** @param {Element} el */
    function mountTo(el) {
    if (!(el instanceof HTMLElement)) return;

      const prevRect = currentEl ? currentEl.getBoundingClientRect() : null;

      el.style.position = "relative";
      el.insertBefore(pill, el.firstChild);

      const nextRect = el.getBoundingClientRect();

      if (!prevRect) {
        pill.style.opacity = "1";
        pill.style.transform = "none";
        currentEl = el;
        return;
      }

      const dx = prevRect.left - nextRect.left;
      const dy = prevRect.top - nextRect.top;
      const sx = prevRect.width / nextRect.width;
      const sy = prevRect.height / nextRect.height;

      pill.style.transition = "none";
      pill.style.opacity = "1";
      pill.style.transform = `translate3d(${dx}px, ${dy}px, 0) scale(${sx}, ${sy})`;

      pill.getBoundingClientRect(); // force reflow

      requestAnimationFrame(() => {
        pill.style.transition = "opacity 300ms cubic-bezier(.2,.8,.2,1), transform 300ms cubic-bezier(.2,.8,.2,1)";
        pill.style.transform = "none";
      });

      currentEl = el;
    }

    function hidePill() {
      pill.style.opacity = "0";
    }

    if (desktopNav && items.length) {
      items.forEach((el) => {
        el.addEventListener("mouseenter", () => mountTo(el));
        el.addEventListener("focus", () => mountTo(el));
      });

      desktopNav.addEventListener("mouseleave", hidePill);

      window.addEventListener("resize", () => {
        if (currentEl && pill.parentElement === currentEl) {
          pill.style.transform = "none";
        }
      });
    }
  }
</script>
</nav>
